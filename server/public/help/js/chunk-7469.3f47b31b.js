(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7469"],{"3afd":function(e,t,a){},"7c5e":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Card",{staticClass:"categoryCard"},[a("div",{staticClass:"operateBar"},[a("div",{staticClass:"operateBarLeft"},[a("Select",{staticStyle:{width:"150px","margin-right":"10px"},on:{"on-change":e.selectChange},model:{value:e.select.model,callback:function(t){e.$set(e.select,"model",t)},expression:"select.model"}},e._l(e.select.options,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])})),a("LanguageSelector",{staticStyle:{width:"200px"},on:{"on-change":e.languageSelectorChangeHandle}})],1),a("Button",{attrs:{type:"primary"},on:{click:e.newCategory}},[e._v("新建分类")])],1),a("Table",{attrs:{border:"",columns:e.categoryColumns,data:e.categoryData}}),a("Modal",{attrs:{width:"560","mask-closable":!1},model:{value:e.editModal.visible,callback:function(t){e.$set(e.editModal,"visible",t)},expression:"editModal.visible"}},[a("p",{attrs:{slot:"header"},slot:"header"},[e._v(e._s(e.editModal.title))]),a("div",{staticClass:"editModalContent"},[a("Form",{ref:"editModal",attrs:{model:e.editModal.formData,"label-width":100,rules:e.ruleCustom}},[a("FormItem",{attrs:{label:"选择语言：",prop:"lang"}},[a("LanguageSelector",{attrs:{lang:e.language},on:{"on-change":e.editLangChangeHandle}})],1),a("FormItem",{attrs:{label:"分类名称：",prop:"value"}},[a("Input",{attrs:{placeholder:"输入分类名称"},model:{value:e.editModal.formData.value,callback:function(t){e.$set(e.editModal.formData,"value",t)},expression:"editModal.formData.value"}})],1),a("FormItem",{attrs:{label:"分类优先级：",prop:"order"}},[a("Input",{attrs:{placeholder:"输入分类英文名称"},on:{"on-keyup":function(){e.editModal.formData.order=e.editModal.formData.order.replace(/[^\d]/g,"")}},model:{value:e.editModal.formData.order,callback:function(t){e.$set(e.editModal.formData,"order",t)},expression:"editModal.formData.order"}})],1),a("FormItem",{attrs:{prop:"iconfocus"}},[a("div",{attrs:{slot:"label"},slot:"label"},[a("span",{staticClass:"required"},[e._v("点击图标：")])]),a("div",{staticStyle:{display:"flex","align-items":"center"}},[e._l(e.focusIconList,function(t){return a("div",{staticClass:"uploadList"},["finished"===t.status?[a("img",{attrs:{src:t.url}}),a("div",{staticClass:"uploadCover"},[a("Icon",{attrs:{type:"ios-trash-outline",size:"40"},nativeOn:{click:function(a){e.handleRemove(t,"uploadFocusIcon")}}})],1)]:[t.showProgress?a("Progress",{attrs:{percent:t.percentage,"hide-info":""}}):e._e()]],2)}),a("Upload",{directives:[{name:"show",rawName:"v-show",value:0===e.focusIconList.length,expression:"focusIconList.length===0"}],ref:"uploadFocusIcon",staticStyle:{display:"inline-block",width:"100px",height:"100px"},attrs:{type:"drag","show-upload-list":!1,format:["jpg","jpeg","png"],"max-size":500,"before-upload":e.handleCheckSize,"default-file-list":e.defaultFocusIconList,"on-format-error":e.handleFormatError,"on-exceeded-size":e.handleMaxSize,"on-success":e.handleSuccess("defaultFocusIconList","iconfocus"),action:e.uploadUrl}},[a("div",{staticStyle:{width:"100px",height:"100px",display:"flex","justify-content":"center","align-items":"center"}},[a("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"42"}})],1)]),0===e.blurIconList.length?a("span",{staticClass:"tip",staticStyle:{"margin-left":"20px","font-size":"12px","text-align":"center"}},[e._v("\n              支持jpg、jpeg、png格式，宽高比限制为1:1\n              "),a("br"),e._v("点击或拖拽进行上传\n            ")]):a("span",{staticClass:"tip",staticStyle:{"margin-left":"20px","font-size":"12px"}},[e._v("更改图片请先删除原图，再行上传")])],2)]),a("FormItem",{attrs:{prop:"iconblur"}},[a("div",{attrs:{slot:"label"},slot:"label"},[a("span",{staticClass:"required"},[e._v("失焦图标：")])]),a("div",{staticStyle:{display:"flex","align-items":"center"}},[e._l(e.blurIconList,function(t){return a("div",{staticClass:"uploadList"},["finished"===t.status?[a("img",{attrs:{src:t.url}}),a("div",{staticClass:"uploadCover"},[a("Icon",{attrs:{type:"ios-trash-outline",size:"40"},nativeOn:{click:function(a){e.handleRemove(t,"uploadBlurIcon")}}})],1)]:[t.showProgress?a("Progress",{attrs:{percent:t.percentage,"hide-info":""}}):e._e()]],2)}),a("Upload",{directives:[{name:"show",rawName:"v-show",value:0===e.blurIconList.length,expression:"blurIconList.length===0"}],ref:"uploadBlurIcon",staticStyle:{display:"inline-block",width:"100px",height:"100px"},attrs:{type:"drag","show-upload-list":!1,format:["jpg","jpeg","png"],"max-size":500,"before-upload":e.handleCheckSize,"default-file-list":e.defaultBlurIconList,"on-format-error":e.handleFormatError,"on-exceeded-size":e.handleMaxSize,"on-success":e.handleSuccess("defaultBlurIconList","iconblur"),action:e.uploadUrl}},[a("div",{staticStyle:{width:"100px",height:"100px",display:"flex","justify-content":"center","align-items":"center"}},[a("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"42"}})],1)]),0===e.blurIconList.length?a("span",{staticClass:"tip",staticStyle:{"margin-left":"20px","font-size":"12px","text-align":"center"}},[e._v("\n              支持jpg、jpeg、png格式，宽高比限制为1:1\n              "),a("br"),e._v("点击或拖拽进行上传\n            ")]):a("span",{staticClass:"tip",staticStyle:{"margin-left":"20px","font-size":"12px"}},[e._v("更改图片请先删除原图，再行上传")])],2)])],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary",size:"large",long:"",loading:e.editModal.loading},on:{click:e.handleSubmit}},[e._v("提交")])],1)]),a("Modal",{attrs:{width:"460","mask-closable":!1},model:{value:e.checkIconModal.visible,callback:function(t){e.$set(e.checkIconModal,"visible",t)},expression:"checkIconModal.visible"}},[a("p",{attrs:{slot:"header"},slot:"header"},[e._v("查看图标")]),a("Form",{staticStyle:{display:"flex","justify-content":"space-between"},attrs:{"label-width":80}},[a("FormItem",{attrs:{label:"点击图标："}},[a("div",{staticClass:"uploadList"},[a("img",{attrs:{src:e.checkIconModal.iconfocus}})])]),a("FormItem",{attrs:{label:"失焦图标："}},[a("div",{staticClass:"uploadList"},[a("img",{attrs:{src:e.checkIconModal.iconblur}})])])],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary",size:"large",long:""},on:{click:function(t){e.checkIconModal.visible=!1}}},[e._v("确认")])],1)],1),a("Modal",{attrs:{width:"360","mask-closable":!1},model:{value:e.checkOpModal.visible,callback:function(t){e.$set(e.checkOpModal,"visible",t)},expression:"checkOpModal.visible"}},[a("p",{staticStyle:{color:"#f60","text-align":"left"},attrs:{slot:"header"},slot:"header"},[a("span",[e._v("删除分类")])]),a("Input",{attrs:{placeholder:"删除前输入分类名称，防止误操作"},model:{value:e.checkOpModal.checkInput,callback:function(t){e.$set(e.checkOpModal,"checkInput",t)},expression:"checkOpModal.checkInput"}},[a("span",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("分类名称:")])]),a("div",{staticStyle:{"margin-top":"10px","font-size":"14px"}},[e._v("下架后，该分类及其下问题将不出现在帮助中心页面！")]),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{size:"large"},on:{click:function(t){e.checkOpModal.visible=!1}}},[e._v("取消")]),a("Button",{attrs:{type:"primary",size:"large"},on:{click:e.checkHandle}},[e._v("确定")])],1)],1),a("Modal",{attrs:{title:"修改优先级",width:"400"},on:{"on-ok":e.changeOrderHandle},model:{value:e.order.visible,callback:function(t){e.$set(e.order,"visible",t)},expression:"order.visible"}},[a("Input",{on:{"on-keyup":function(){e.order.value=e.order.value.replace(/[^\d]/g,"")}},model:{value:e.order.value,callback:function(t){e.$set(e.order,"value",t)},expression:"order.value"}})],1)],1)},i=[],l=(a("cadf"),a("551c"),a("097d"),function(e){return[{title:"优先级(可编辑)",key:"order",align:"center",minWidth:120,render:function(t,a){return t("Button",{props:{type:"text"},on:{click:function(){e.editOrder(a)}}},a.row.order)}},{title:"分类名称",key:"value",align:"center",minWidth:280},{title:"图标",align:"center",minWidth:160,render:function(t,a){return t("Button",{props:{type:"primary"},on:{click:function(){e.showIcon(a)}}},"查看图标")}},{title:"操作",align:"center",minWidth:200,render:function(t,a){return t("div",[t("Button",{props:{type:"primary"},style:{marginRight:"5px"},on:{click:function(){e.editCategory(a)}}},"编辑"),t("Button",{props:{type:"error"},on:{click:function(){e.deleteCategory(a)}}},"删除")])}}]}),n=a("d06e"),r=a("8fc9"),s={name:"category",components:{LanguageSelector:r["a"]},data:function(){var e=this,t=function(t,a,o){0===e.editModal.formData.iconfocus.length?o(new Error("分类点击图不可为空！")):o()},a=function(t,a,o){0===e.editModal.formData.iconblur.length?o(new Error("分类失焦图不可为空！")):o()},o=function(t,a,o){console.log(e.editModal.formData.order),e.editModal.formData.order<=0?o(new Error("优先级应为大于0的正整数！")):o()};return{language:"zh",uploadUrl:"/api/upload",categoryColumns:l(this),categoryData:[],select:{model:"question",options:[{label:"问题分类",value:"question"},{label:"文件分类",value:"downloads"}]},editModal:{visible:!1,title:"",loading:!1,isEdit:!1,formData:{lang:"zh",value:"",order:"",iconfocus:"",iconblur:""}},ruleCustom:{value:[{required:!0,message:"分类名称不可为空",trigger:"blur"}],lang:[{required:!0,message:"语言不可为空",trigger:"change"}],order:[{validator:o,trigger:"blur"}],iconfocus:[{validator:t,trigger:"blur"}],iconblur:[{validator:a,trigger:"blur"}]},checkIconModal:{visible:!1,iconfocus:"",iconblur:""},icons:{focusIcon:{},blurIcon:{}},defaultFocusIconList:[],focusIconList:[],defaultBlurIconList:[],blurIconList:[],checkOpModal:{visible:!1,checkInput:"",checkStr:""},type:"question",order:{visible:!1,value:"",id:""}}},methods:{requestList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"question";Object(n["c"])(t,this.language).then(function(t){t&&(e.categoryData=t.data.rows)})},newCategory:function(){this.editModal.title="新建分类",this.editModal.visible=!0,this.editModal.isEdit=!1,this.editModal.formData={lang:this.editModal.formData.lang||"zh",value:"",order:"",iconfocus:"",iconblur:""},this.defaultFocusIconList=[],this.defaultBlurIconList=[],this.focusIconList=[],this.blurIconList=[]},showIcon:function(e){this.checkIconModal.iconfocus=e.row.iconfocus,this.checkIconModal.iconblur=e.row.iconblur,this.checkIconModal.visible=!0},editCategory:function(e){var t=this;this.editModal.formData=e.row,this.defaultFocusIconList=[{url:e.row.iconfocus}],this.defaultBlurIconList=[{url:e.row.iconblur}],this.$nextTick(function(){t.focusIconList=t.$refs.uploadFocusIcon.fileList,t.blurIconList=t.$refs.uploadBlurIcon.fileList}),this.editModal.title="编辑分类",this.editModal.visible=!0,this.editModal.isEdit=!0},deleteCategory:function(e){this.checkOpModal.visible=!0,this.checkOpModal.checkStr=e.row.value,this.checkOpModal.checkInput="",this.checkOpModal.id=e.row.id},checkHandle:function(){var e=this;this.checkOpModal.visible=!1,console.log(this.checkOpModal.checkStr,this.checkOpModal.checkInput),this.checkOpModal.checkStr.trim()===this.checkOpModal.checkInput.trim()?Object(n["a"])(this.checkOpModal.id,this.type).then(function(t){t&&(e.requestList(e.type),e.$Message.success("删除分类成功！"))}):this.$Message.error("输入名称与实际不符！")},selectChange:function(e){this.type=e,this.requestList(e)},handleFormatError:function(){this.$Message.error("不支持上传该图片格式，请选择jpg,jpeg或png。")},handleMaxSize:function(){this.$Message.error("图片大小超出限制，请上传不超过500KB的图片。")},handleCheckSize:function(e){var t=this,a=!1;return new Promise(function(o,i){var l=new FileReader;l.onload=function(e){var l=e.target.result,n=new Image;n.onload=function(){var e=n.width,l=n.height;t.ifMatch=!0,e===l?(a=!0,o()):(a=!1,i())},n.src=l},l.readAsDataURL(e)}).then(function(e){console.log("match")}).catch().finally(function(e){a||t.$Message.error("请上传正确宽高比的图片！")})},handleRemove:function(e,t){var a="";"uploadFocusIcon"===t?a="iconfocus":"uploadBlurIcon"===t&&(a="iconblur");var o=this.$refs[t].fileList;this.editModal.formData[a];o.splice(o.indexOf(e),1)},handleSuccess:function(e,t){var a=this;return function(o,i){i.url=location.origin+o.data.url,a[e]=[i],a.editModal.formData[t]=location.origin+o.data.url,a.$nextTick(function(){a.focusIconList=a.$refs.uploadFocusIcon.fileList,a.blurIconList=a.$refs.uploadBlurIcon.fileList})}},handleSubmit:function(){var e=this;console.log(this.editModal.formData.lang),this.$refs.editModal.validate(function(t){t&&(e.editModal.loading=!0,Object(n["d"])(e.editModal.formData,e.type,e.editModal.isEdit).then(function(t){t&&(e.$Message.success(e.editModal.isEdit?"编辑分类成功！":"新建分类成功！"),e.requestList(e.type)),e.editModal.visible=!1,e.editModal.loading=!1}))})},editOrder:function(e){this.order.visible=!0,this.order.value=e.row.order,this.order.id=e.row.id},changeOrderHandle:function(){var e=this;Object(n["b"])(this.order.id,this.order.value).then(function(t){t&&e.requestList(e.type)})},languageSelectorChangeHandle:function(e){this.language=e,this.requestList(this.type)},editLangChangeHandle:function(e){this.editModal.formData.lang=e,console.log(e,this.editModal.formData.lang)}},mounted:function(){this.requestList(),this.focusIconList=this.$refs.uploadFocusIcon.fileList,this.blurIconList=this.$refs.uploadBlurIcon.fileList}},c=s,d=(a("a74b"),a("2877")),u=Object(d["a"])(c,o,i,!1,null,"3aacce9b",null);u.options.__file="category.vue";t["default"]=u.exports},"8fc9":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Select",{attrs:{filterable:"",disabled:e.disabled||!1},on:{"on-change":e.languageChangeHandle},model:{value:e.defaultLang,callback:function(t){e.defaultLang=t},expression:"defaultLang"}},e._l(e.languageList,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))},i=[],l=[{value:"zh",label:"中文"},{value:"en",label:"英文"},{value:"vi",label:"越南语"},{value:"es",label:"西班牙语"},{value:"pt",label:"葡萄牙语"},{value:"ko",label:"韩语"}],n={name:"language-selector",props:{disabled:{type:Boolean,default:function(){return!1}},lang:{type:String,default:function(){return"zh"}}},data:function(){return{languageList:l,defaultLang:this.lang||"zh"}},watch:{lang:function(e){this.defaultLang=e||"zh",this.$emit("on-change",e)}},methods:{languageChangeHandle:function(e){console.log(e),this.defaultLang=e,this.$emit("on-change",e)}}},r=n,s=(a("f9f5"),a("2877")),c=Object(s["a"])(r,o,i,!1,null,null,null);c.options.__file="language-selector.vue";t["a"]=c.exports},a74b:function(e,t,a){"use strict";var o=a("3afd"),i=a.n(o);i.a},d06e:function(e,t,a){"use strict";a.d(t,"c",function(){return i}),a.d(t,"a",function(){return l}),a.d(t,"d",function(){return n}),a.d(t,"b",function(){return r});var o=a("66df"),i=function(e,t){var a="/api/category/"+e;return o["a"].request({url:a,params:{lang:t},method:"GET"})},l=function(e,t){var a="/api/category/"+t;return o["a"].request({url:a,method:"DELETE",params:{id:e}})},n=function(e,t,a){var i=e.id,l=e.lang,n=e.value,r=e.order,s=e.iconfocus,c=e.iconblur,d="/api/category/"+t;return o["a"].request({url:d,method:a?"PUT":"POST",params:a?{id:i,lang:l,value:n,order:r,iconfocus:s,iconblur:c}:{lang:l,value:n,order:r,iconfocus:s,iconblur:c}})},r=function(e,t){return o["a"].request({url:"/api/categoryOrder",method:"PUT",data:{id:e,order:t}})}},dc1b:function(e,t,a){},f9f5:function(e,t,a){"use strict";var o=a("dc1b"),i=a.n(o);i.a}}]);