(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0a11"],{1571:function(t,e,a){"use strict";var o=a("9d96"),i=a.n(o);i.a},"7c5e":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Card",{staticClass:"categoryCard"},[a("div",{staticClass:"operateBar"},[a("div",{staticClass:"operateBarLeft"},[a("Select",{staticStyle:{width:"150px","margin-right":"10px"},on:{"on-change":t.selectChange},model:{value:t.select.model,callback:function(e){t.$set(t.select,"model",e)},expression:"select.model"}},t._l(t.select.options,function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),a("LanguageSelector",{staticStyle:{width:"200px"},on:{"on-change":t.languageSelectorChangeHandle}})],1),a("Button",{attrs:{type:"primary"},on:{click:t.newCategory}},[t._v("新建分类")])],1),a("Table",{attrs:{border:"",columns:t.categoryColumns,data:t.categoryData}}),a("Modal",{attrs:{width:"560","mask-closable":!1},model:{value:t.editModal.visible,callback:function(e){t.$set(t.editModal,"visible",e)},expression:"editModal.visible"}},[a("p",{attrs:{slot:"header"},slot:"header"},[t._v(t._s(t.editModal.title))]),a("div",{staticClass:"editModalContent"},[a("Form",{ref:"editModal",attrs:{model:t.editModal.formData,"label-width":100,rules:t.ruleCustom}},[a("FormItem",{attrs:{label:"选择语言：",prop:"lang"}},[a("LanguageSelector",{attrs:{lang:t.language},on:{"on-change":t.editLangChangeHandle}})],1),a("FormItem",{attrs:{label:"分类名称：",prop:"value"}},[a("Input",{attrs:{placeholder:"输入分类名称"},model:{value:t.editModal.formData.value,callback:function(e){t.$set(t.editModal.formData,"value",e)},expression:"editModal.formData.value"}})],1),a("FormItem",{attrs:{label:"分类优先级：",prop:"order"}},[a("Input",{attrs:{placeholder:"输入分类英文名称"},on:{"on-keyup":function(){t.editModal.formData.order=t.editModal.formData.order.replace(/[^\d]/g,"")}},model:{value:t.editModal.formData.order,callback:function(e){t.$set(t.editModal.formData,"order",e)},expression:"editModal.formData.order"}})],1),a("FormItem",{attrs:{prop:"iconfocus"}},[a("div",{attrs:{slot:"label"},slot:"label"},[a("span",{staticClass:"required"},[t._v("点击图标：")])]),a("div",{staticStyle:{display:"flex","align-items":"center"}},[t._l(t.focusIconList,function(e){return a("div",{staticClass:"uploadList"},["finished"===e.status?[a("img",{attrs:{src:e.url}}),a("div",{staticClass:"uploadCover"},[a("Icon",{attrs:{type:"ios-trash-outline",size:"40"},nativeOn:{click:function(a){t.handleRemove(e,"uploadFocusIcon")}}})],1)]:[e.showProgress?a("Progress",{attrs:{percent:e.percentage,"hide-info":""}}):t._e()]],2)}),a("Upload",{directives:[{name:"show",rawName:"v-show",value:0===t.focusIconList.length,expression:"focusIconList.length===0"}],ref:"uploadFocusIcon",staticStyle:{display:"inline-block",width:"100px",height:"100px"},attrs:{type:"drag","show-upload-list":!1,format:["jpg","jpeg","png"],"max-size":500,"before-upload":t.handleCheckSize,"default-file-list":t.defaultFocusIconList,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize,"on-success":t.handleSuccess("defaultFocusIconList","iconfocus"),action:t.uploadUrl}},[a("div",{staticStyle:{width:"100px",height:"100px",display:"flex","justify-content":"center","align-items":"center"}},[a("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"42"}})],1)]),0===t.blurIconList.length?a("span",{staticClass:"tip",staticStyle:{"margin-left":"20px","font-size":"12px","text-align":"center"}},[t._v("\n              支持jpg、jpeg、png格式，宽高比限制为1:1\n              "),a("br"),t._v("点击或拖拽进行上传\n            ")]):a("span",{staticClass:"tip",staticStyle:{"margin-left":"20px","font-size":"12px"}},[t._v("更改图片请先删除原图，再行上传")])],2)]),a("FormItem",{attrs:{prop:"iconblur"}},[a("div",{attrs:{slot:"label"},slot:"label"},[a("span",{staticClass:"required"},[t._v("失焦图标：")])]),a("div",{staticStyle:{display:"flex","align-items":"center"}},[t._l(t.blurIconList,function(e){return a("div",{staticClass:"uploadList"},["finished"===e.status?[a("img",{attrs:{src:e.url}}),a("div",{staticClass:"uploadCover"},[a("Icon",{attrs:{type:"ios-trash-outline",size:"40"},nativeOn:{click:function(a){t.handleRemove(e,"uploadBlurIcon")}}})],1)]:[e.showProgress?a("Progress",{attrs:{percent:e.percentage,"hide-info":""}}):t._e()]],2)}),a("Upload",{directives:[{name:"show",rawName:"v-show",value:0===t.blurIconList.length,expression:"blurIconList.length===0"}],ref:"uploadBlurIcon",staticStyle:{display:"inline-block",width:"100px",height:"100px"},attrs:{type:"drag","show-upload-list":!1,format:["jpg","jpeg","png"],"max-size":500,"before-upload":t.handleCheckSize,"default-file-list":t.defaultBlurIconList,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize,"on-success":t.handleSuccess("defaultBlurIconList","iconblur"),action:t.uploadUrl}},[a("div",{staticStyle:{width:"100px",height:"100px",display:"flex","justify-content":"center","align-items":"center"}},[a("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"42"}})],1)]),0===t.blurIconList.length?a("span",{staticClass:"tip",staticStyle:{"margin-left":"20px","font-size":"12px","text-align":"center"}},[t._v("\n              支持jpg、jpeg、png格式，宽高比限制为1:1\n              "),a("br"),t._v("点击或拖拽进行上传\n            ")]):a("span",{staticClass:"tip",staticStyle:{"margin-left":"20px","font-size":"12px"}},[t._v("更改图片请先删除原图，再行上传")])],2)])],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary",size:"large",long:"",loading:t.editModal.loading},on:{click:t.handleSubmit}},[t._v("提交")])],1)]),a("Modal",{attrs:{width:"460","mask-closable":!1},model:{value:t.checkIconModal.visible,callback:function(e){t.$set(t.checkIconModal,"visible",e)},expression:"checkIconModal.visible"}},[a("p",{attrs:{slot:"header"},slot:"header"},[t._v("查看图标")]),a("Form",{staticStyle:{display:"flex","justify-content":"space-between"},attrs:{"label-width":80}},[a("FormItem",{attrs:{label:"点击图标："}},[a("div",{staticClass:"uploadList"},[a("img",{attrs:{src:t.checkIconModal.iconfocus}})])]),a("FormItem",{attrs:{label:"失焦图标："}},[a("div",{staticClass:"uploadList"},[a("img",{attrs:{src:t.checkIconModal.iconblur}})])])],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary",size:"large",long:""},on:{click:function(e){t.checkIconModal.visible=!1}}},[t._v("确认")])],1)],1),a("Modal",{attrs:{width:"360","mask-closable":!1},model:{value:t.checkOpModal.visible,callback:function(e){t.$set(t.checkOpModal,"visible",e)},expression:"checkOpModal.visible"}},[a("p",{staticStyle:{color:"#f60","text-align":"left"},attrs:{slot:"header"},slot:"header"},[a("span",[t._v("删除分类")])]),a("Input",{attrs:{placeholder:"删除前输入分类名称，防止误操作"},model:{value:t.checkOpModal.checkInput,callback:function(e){t.$set(t.checkOpModal,"checkInput",e)},expression:"checkOpModal.checkInput"}},[a("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("分类名称:")])]),a("div",{staticStyle:{"margin-top":"10px","font-size":"14px"}},[t._v("下架后，该分类及其下问题将不出现在帮助中心页面！")]),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{size:"large"},on:{click:function(e){t.checkOpModal.visible=!1}}},[t._v("取消")]),a("Button",{attrs:{type:"primary",size:"large"},on:{click:t.checkHandle}},[t._v("确定")])],1)],1),a("Modal",{attrs:{title:"修改优先级",width:"400"},on:{"on-ok":t.changeOrderHandle},model:{value:t.order.visible,callback:function(e){t.$set(t.order,"visible",e)},expression:"order.visible"}},[a("Input",{on:{"on-keyup":function(){t.order.value=t.order.value.replace(/[^\d]/g,"")}},model:{value:t.order.value,callback:function(e){t.$set(t.order,"value",e)},expression:"order.value"}})],1)],1)},i=[],l=(a("cadf"),a("551c"),a("097d"),function(t){return[{title:"优先级(可编辑)",key:"order",align:"center",minWidth:120,render:function(e,a){return e("Button",{props:{type:"text"},on:{click:function(){t.editOrder(a)}}},a.row.order)}},{title:"分类名称",key:"value",align:"center",minWidth:280},{title:"图标",align:"center",minWidth:160,render:function(e,a){return e("Button",{props:{type:"primary"},on:{click:function(){t.showIcon(a)}}},"查看图标")}},{title:"操作",align:"center",minWidth:200,render:function(e,a){return e("div",[e("Button",{props:{type:"primary"},style:{marginRight:"5px"},on:{click:function(){t.editCategory(a)}}},"编辑"),e("Button",{props:{type:"error"},on:{click:function(){t.deleteCategory(a)}}},"删除")])}}]}),n=a("d06e"),r=a("8fc9"),s={name:"category",components:{LanguageSelector:r["a"]},data:function(){var t=this,e=function(e,a,o){0===t.editModal.formData.iconfocus.length?o(new Error("分类点击图不可为空！")):o()},a=function(e,a,o){0===t.editModal.formData.iconblur.length?o(new Error("分类失焦图不可为空！")):o()},o=function(e,a,o){console.log(t.editModal.formData.order),t.editModal.formData.order<=0?o(new Error("优先级应为大于0的正整数！")):o()};return{language:"zh",uploadUrl:"/api/upload",categoryColumns:l(this),categoryData:[],select:{model:"question",options:[{label:"问题分类",value:"question"},{label:"文件分类",value:"downloads"}]},editModal:{visible:!1,title:"",loading:!1,isEdit:!1,formData:{lang:"zh",value:"",order:"",iconfocus:"",iconblur:""}},ruleCustom:{value:[{required:!0,message:"分类名称不可为空",trigger:"blur"}],lang:[{required:!0,message:"语言不可为空",trigger:"change"}],order:[{validator:o,trigger:"blur"}],iconfocus:[{validator:e,trigger:"blur"}],iconblur:[{validator:a,trigger:"blur"}]},checkIconModal:{visible:!1,iconfocus:"",iconblur:""},icons:{focusIcon:{},blurIcon:{}},defaultFocusIconList:[],focusIconList:[],defaultBlurIconList:[],blurIconList:[],checkOpModal:{visible:!1,checkInput:"",checkStr:""},type:"question",order:{visible:!1,value:"",id:""}}},methods:{requestList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"question";Object(n["c"])(e,this.language).then(function(e){e&&(t.categoryData=e.data.rows)})},newCategory:function(){this.editModal.title="新建分类",this.editModal.visible=!0,this.editModal.isEdit=!1,this.editModal.formData={lang:this.editModal.formData.lang||"zh",value:"",order:"",iconfocus:"",iconblur:""},this.defaultFocusIconList=[],this.defaultBlurIconList=[],this.focusIconList=[],this.blurIconList=[]},showIcon:function(t){this.checkIconModal.iconfocus=location.origin+t.row.iconfocus,this.checkIconModal.iconblur=location.origin+t.row.iconblur,this.checkIconModal.visible=!0},editCategory:function(t){var e=this;this.editModal.formData=t.row,this.defaultFocusIconList=[{url:t.row.iconfocus}],this.defaultBlurIconList=[{url:t.row.iconblur}],this.$nextTick(function(){e.focusIconList=e.$refs.uploadFocusIcon.fileList,e.blurIconList=e.$refs.uploadBlurIcon.fileList}),this.editModal.title="编辑分类",this.editModal.visible=!0,this.editModal.isEdit=!0},deleteCategory:function(t){this.checkOpModal.visible=!0,this.checkOpModal.checkStr=t.row.value,this.checkOpModal.checkInput="",this.checkOpModal.id=t.row.id},checkHandle:function(){var t=this;this.checkOpModal.visible=!1,console.log(this.checkOpModal.checkStr,this.checkOpModal.checkInput),this.checkOpModal.checkStr.trim()===this.checkOpModal.checkInput.trim()?Object(n["a"])(this.checkOpModal.id,this.type).then(function(e){e&&(t.requestList(t.type),t.$Message.success("删除分类成功！"))}):this.$Message.error("输入名称与实际不符！")},selectChange:function(t){this.type=t,this.requestList(t)},handleFormatError:function(){this.$Message.error("不支持上传该图片格式，请选择jpg,jpeg或png。")},handleMaxSize:function(){this.$Message.error("图片大小超出限制，请上传不超过500KB的图片。")},handleCheckSize:function(t){var e=this,a=!1;return new Promise(function(o,i){var l=new FileReader;l.onload=function(t){var l=t.target.result,n=new Image;n.onload=function(){var t=n.width,l=n.height;e.ifMatch=!0,t===l?(a=!0,o()):(a=!1,i())},n.src=l},l.readAsDataURL(t)}).then(function(t){console.log("match")}).catch().finally(function(t){a||e.$Message.error("请上传正确宽高比的图片！")})},handleRemove:function(t,e){var a="";"uploadFocusIcon"===e?a="iconfocus":"uploadBlurIcon"===e&&(a="iconblur");var o=this.$refs[e].fileList;this.editModal.formData[a];o.splice(o.indexOf(t),1)},handleSuccess:function(t,e){var a=this;return function(o,i){i.url=location.origin+o.data.url,a[t]=[i],a.editModal.formData[e]=location.origin+o.data.url,a.$nextTick(function(){a.focusIconList=a.$refs.uploadFocusIcon.fileList,a.blurIconList=a.$refs.uploadBlurIcon.fileList})}},handleSubmit:function(){var t=this;console.log(this.editModal.formData.lang),this.$refs.editModal.validate(function(e){e&&(t.editModal.loading=!0,Object(n["d"])(t.editModal.formData,t.type,t.editModal.isEdit).then(function(e){e&&(t.$Message.success(t.editModal.isEdit?"编辑分类成功！":"新建分类成功！"),t.requestList(t.type)),t.editModal.visible=!1,t.editModal.loading=!1}))})},editOrder:function(t){this.order.visible=!0,this.order.value=t.row.order,this.order.id=t.row.id},changeOrderHandle:function(){var t=this;Object(n["b"])(this.order.id,this.order.value).then(function(e){e&&t.requestList(t.type)})},languageSelectorChangeHandle:function(t){this.language=t,this.requestList(this.type)},editLangChangeHandle:function(t){this.editModal.formData.lang=t,console.log(t,this.editModal.formData.lang)}},mounted:function(){this.requestList(),this.focusIconList=this.$refs.uploadFocusIcon.fileList,this.blurIconList=this.$refs.uploadBlurIcon.fileList}},c=s,d=(a("1571"),a("2877")),u=Object(d["a"])(c,o,i,!1,null,"0576ee9b",null);u.options.__file="category.vue";e["default"]=u.exports},"8fc9":function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Select",{attrs:{filterable:"",disabled:t.disabled||!1},on:{"on-change":t.languageChangeHandle},model:{value:t.defaultLang,callback:function(e){t.defaultLang=e},expression:"defaultLang"}},t._l(t.languageList,function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}))},i=[],l=[{value:"zh",label:"中文"},{value:"en",label:"英文"},{value:"vi",label:"越南语"},{value:"es",label:"西班牙语"},{value:"pt",label:"葡萄牙语"},{value:"ko",label:"韩语"}],n={name:"language-selector",props:{disabled:{type:Boolean,default:function(){return!1}},lang:{type:String,default:function(){return"zh"}}},data:function(){return{languageList:l,defaultLang:this.lang||"zh"}},watch:{lang:function(t){this.defaultLang=t||"zh",this.$emit("on-change",t)}},methods:{languageChangeHandle:function(t){console.log(t),this.defaultLang=t,this.$emit("on-change",t)}}},r=n,s=(a("f9f5"),a("2877")),c=Object(s["a"])(r,o,i,!1,null,null,null);c.options.__file="language-selector.vue";e["a"]=c.exports},"9d96":function(t,e,a){},d06e:function(t,e,a){"use strict";a.d(e,"c",function(){return i}),a.d(e,"a",function(){return l}),a.d(e,"d",function(){return n}),a.d(e,"b",function(){return r});var o=a("66df"),i=function(t,e){var a="/api/category/"+t;return o["a"].request({url:a,params:{lang:e},method:"GET"})},l=function(t,e){var a="/api/category/"+e;return o["a"].request({url:a,method:"DELETE",params:{id:t}})},n=function(t,e,a){var i=t.id,l=t.lang,n=t.value,r=t.order,s=t.iconfocus,c=t.iconblur,d="/api/category/"+e;return o["a"].request({url:d,method:a?"PUT":"POST",params:a?{id:i,lang:l,value:n,order:r,iconfocus:s,iconblur:c}:{lang:l,value:n,order:r,iconfocus:s,iconblur:c}})},r=function(t,e){return o["a"].request({url:"/api/categoryOrder",method:"PUT",data:{id:t,order:e}})}},dc1b:function(t,e,a){},f9f5:function(t,e,a){"use strict";var o=a("dc1b"),i=a.n(o);i.a}}]);