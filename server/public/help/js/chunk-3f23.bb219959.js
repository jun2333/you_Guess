(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3f23"],{"5bf6":function(t,a,e){"use strict";var r=e("960e"),n=e.n(r);n.a},"6c8e":function(t,a,e){"use strict";e.r(a);var r=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("Card",[t.spinShow?e("Spin",{attrs:{size:"large",fix:""}}):t._e(),e("Form",{attrs:{"label-width":100,model:t.formData,rules:t.ruleCustom}},[e("FormItem",{attrs:{label:"选择语言："}},[e("LanguageSelector",{staticStyle:{width:"300px"},attrs:{disabled:t.isEdit,lang:t.formData.lang},on:{"on-change":t.langChangeHandle}})],1),e("Row",[e("Col",{attrs:{span:12}},[e("FormItem",{attrs:{label:"文件分类："}},[e("Select",{staticStyle:{width:"300px"},model:{value:t.formData.type,callback:function(a){t.$set(t.formData,"type",a)},expression:"formData.type"}},t._l(t.category,function(a){return e("Option",{key:a.id,attrs:{value:a.id}},[t._v(t._s(a.value))])}))],1)],1),e("Col",{attrs:{span:12}},[e("FormItem",{attrs:{label:"优先级：",prop:"order"}},[e("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"文件优先级"},on:{"on-keyup":function(){t.formData.order=t.formData.order.replace(/[^\d]/g,"")}},model:{value:t.formData.order,callback:function(a){t.$set(t.formData,"order",a)},expression:"formData.order"}})],1)],1)],1),e("Row",[e("Col",{attrs:{span:12}},[e("FormItem",{attrs:{label:"文件版本号："}},[e("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"文件版本号"},model:{value:t.formData.version,callback:function(a){t.$set(t.formData,"version",a)},expression:"formData.version"}})],1)],1),e("Col",{attrs:{span:12}},[e("FormItem",{attrs:{label:"发布时间："}},[e("DatePicker",{staticStyle:{width:"300px"},attrs:{value:t.formData.pubdate,type:"date",placeholder:"YYYY-MM-DD格式日期"},on:{"on-change":t.handleDatePicker}})],1)],1)],1),e("Row",[e("Col",{attrs:{span:12}},[e("FormItem",{attrs:{label:"文件上传："}},[e("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"文件下载链接"},model:{value:t.formData.url,callback:function(a){t.$set(t.formData,"url",a)},expression:"formData.url"}}),e("Upload",{staticStyle:{display:"inline-block","margin-left":"10px"},attrs:{action:t.uploadUrl,"show-upload-list":!1,"before-upload":function(){t.spinShow=!0},"on-success":t.fileUploadSuccessHandle,"on-error":t.fileUploaderrorHandle}},[e("Button",{attrs:{icon:"ios-cloud-upload-outline",type:"success"}},[t._v("点击上传")])],1)],1)],1),e("Col",{attrs:{span:12}},[e("FormItem",{attrs:{label:"文件大小："}},[e("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"文件大小"},model:{value:t.formData.size,callback:function(a){t.$set(t.formData,"size",a)},expression:"formData.size"}})],1)],1)],1)],1),e("Form",[e("FormItem",{attrs:{label:"标题："}},[e("Input",{attrs:{placeholder:"Enter something..."},model:{value:t.formData.name,callback:function(a){t.$set(t.formData,"name",a)},expression:"formData.name"}})],1),e("FormItem",{staticStyle:{"margin-bottom":"0"},attrs:{label:"文件描述："}},[e("Input",{attrs:{type:"textarea",autosize:{minRows:10,maxRows:30},placeholder:"Enter something..."},model:{value:t.formData.msg,callback:function(a){t.$set(t.formData,"msg",a)},expression:"formData.msg"}})],1)],1),e("div",{staticClass:"buttonGroup"},[e("Button",{attrs:{type:"primary",size:"large"},on:{click:t.submitHandle}},[t._v("提交")]),e("Button",{attrs:{size:"large"},on:{click:t.resetHandle}},[t._v("重置")])],1)],1)},n=[],o=(e("a481"),e("c93e")),l=(e("cadf"),e("551c"),e("097d"),e("d06e")),s=e("a4f6"),i=e("8fc9"),u={name:"fileEdit",components:{LanguageSelector:i["a"]},data:function(){var t=this,a=function(a,e,r){t.formData.order<=0?r(new Error("优先级应为大于0的正整数！")):r()};return{uploadUrl:"/api/upload",isEdit:!1,spinShow:!1,category:[],formData:{lang:"zh",type:"",name:"",version:"",url:"",msg:"",pubdate:"",size:"",order:""},ruleCustom:{order:[{validator:a,trigger:"blur"}]}}},methods:{requestCategory:function(){var t=this;Object(l["c"])("downloads",this.formData.lang).then(function(a){a.data.count>0?(t.category=a.data.rows,t.formData.type=a.data.rows[0].id):t.$Modal.confirm({title:"提示",content:"<p>当前语言下暂无分类，请先创建分类！</p>",onOk:function(){t.$router.push({name:"category"})}})})},handleDatePicker:function(t,a){this.formData.pubdate=t},resetHandle:function(){this.formData=Object(o["a"])({type:this.formData.type},{lang:"zh",url:"",name:"",msg:"",version:"",pubdate:"",size:""})},submitHandle:function(){var t=this;this.formData.msg=this.formData.msg.replace("\n","<br>"),Object(s["b"])(this.formData,this.$route.params.id).then(function(a){a&&(t.$route.params.id?(t.$Message.success("编辑文件成功！"),t.$store.commit("closeTag",t.$route),t.$router.push({name:"file-list"})):(t.resetHandle(),t.$Message.success("新建文件成功！")))})},fileUploadSuccessHandle:function(t,a,e){this.spinShow=!1,1===t.status?(this.$Message.success("文件上传成功！"),this.formData.url=location.origin+t.data.url,this.formData.size=t.data.size):10012===t.status?(sessionStorage.clear(),this.$Message.error("登录超时,请重新登录!"),this.$router.push({name:"login"})):this.$Message.error(t.msg)},fileUploaderrorHandle:function(t,a,e){this.spinShow=!1},langChangeHandle:function(t){this.formData.lang=t,this.requestCategory()}},mounted:function(){var t=this,a=this.$route.params.id;a?(this.isEdit=!0,Object(s["a"])(a).then(function(a){a&&(t.formData=a.data,t.requestCategory())})):this.requestCategory()}},c=u,d=(e("5bf6"),e("2877")),f=Object(d["a"])(c,r,n,!1,null,"f86e9246",null);f.options.__file="fileEdit.vue";a["default"]=f.exports},"8fc9":function(t,a,e){"use strict";var r=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("Select",{attrs:{filterable:"",disabled:t.disabled||!1},on:{"on-change":t.languageChangeHandle},model:{value:t.defaultLang,callback:function(a){t.defaultLang=a},expression:"defaultLang"}},t._l(t.languageList,function(a){return e("Option",{key:a.value,attrs:{value:a.value}},[t._v(t._s(a.label))])}))},n=[],o=[{value:"zh",label:"中文"},{value:"en",label:"英文"},{value:"vi",label:"越南语"},{value:"es",label:"西班牙语"},{value:"pt",label:"葡萄牙语"},{value:"ko",label:"韩语"}],l={name:"language-selector",props:{disabled:{type:Boolean,default:function(){return!1}},lang:{type:String,default:function(){return"zh"}}},data:function(){return{languageList:o,defaultLang:this.lang||"zh"}},watch:{lang:function(t){this.defaultLang=t||"zh",this.$emit("on-change",t)}},methods:{languageChangeHandle:function(t){console.log(t),this.defaultLang=t,this.$emit("on-change",t)}}},s=l,i=(e("f9f5"),e("2877")),u=Object(i["a"])(s,r,n,!1,null,null,null);u.options.__file="language-selector.vue";a["a"]=u.exports},"960e":function(t,a,e){},a4f6:function(t,a,e){"use strict";e.d(a,"b",function(){return s}),e.d(a,"a",function(){return i});var r=e("c93e"),n=e("66df"),o=function(t,a){var e="PUT",o=Object(r["a"])({},t,{id:a});return n["a"].request({url:"/api/downloads/".concat(a),method:e,data:o})},l=function(t){var a="POST",e=t;return n["a"].request({url:"/api/downloads",method:a,data:e})},s=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return-1===a?l(t):o(t,a)},i=function(t){return n["a"].request({url:"/api/downloads/".concat(t),method:"GET"})}},d06e:function(t,a,e){"use strict";e.d(a,"c",function(){return n}),e.d(a,"a",function(){return o}),e.d(a,"d",function(){return l}),e.d(a,"b",function(){return s});var r=e("66df"),n=function(t,a){var e="/api/category/"+t;return r["a"].request({url:e,params:{lang:a},method:"GET"})},o=function(t,a){var e="/api/category/"+a;return r["a"].request({url:e,method:"DELETE",params:{id:t}})},l=function(t,a,e){var n=t.id,o=t.lang,l=t.value,s=t.order,i=t.iconfocus,u=t.iconblur,c="/api/category/"+a;return r["a"].request({url:c,method:e?"PUT":"POST",params:e?{id:n,lang:o,value:l,order:s,iconfocus:i,iconblur:u}:{lang:o,value:l,order:s,iconfocus:i,iconblur:u}})},s=function(t,a){return r["a"].request({url:"/api/categoryOrder",method:"PUT",data:{id:t,order:a}})}},dc1b:function(t,a,e){},f9f5:function(t,a,e){"use strict";var r=e("dc1b"),n=e.n(r);n.a}}]);